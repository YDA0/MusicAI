{"ast":null,"code":"import { LowpassCombFilter } from \"../component/filter/LowpassCombFilter\";\nimport { deepMerge } from \"../core/util/Defaults\";\nimport { optionsFromArguments } from \"../core/util/Defaults\";\nimport { Noise } from \"../source/Noise\";\nimport { Instrument } from \"./Instrument\";\n/**\n * Karplus-String string synthesis.\n * @example\n * const plucky = new Tone.PluckSynth().toDestination();\n * plucky.triggerAttack(\"C4\", \"+0.5\");\n * plucky.triggerAttack(\"C3\", \"+1\");\n * plucky.triggerAttack(\"C2\", \"+1.5\");\n * plucky.triggerAttack(\"C1\", \"+2\");\n * @category Instrument\n */\nexport class PluckSynth extends Instrument {\n  constructor() {\n    super(optionsFromArguments(PluckSynth.getDefaults(), arguments));\n    this.name = \"PluckSynth\";\n    const options = optionsFromArguments(PluckSynth.getDefaults(), arguments);\n    this._noise = new Noise({\n      context: this.context,\n      type: \"pink\"\n    });\n    this.attackNoise = options.attackNoise;\n    this._lfcf = new LowpassCombFilter({\n      context: this.context,\n      dampening: options.dampening,\n      resonance: options.resonance\n    });\n    this.resonance = options.resonance;\n    this.release = options.release;\n    this._noise.connect(this._lfcf);\n    this._lfcf.connect(this.output);\n  }\n  static getDefaults() {\n    return deepMerge(Instrument.getDefaults(), {\n      attackNoise: 1,\n      dampening: 4000,\n      resonance: 0.7,\n      release: 1\n    });\n  }\n  /**\n   * The dampening control. i.e. the lowpass filter frequency of the comb filter\n   * @min 0\n   * @max 7000\n   */\n  get dampening() {\n    return this._lfcf.dampening;\n  }\n  set dampening(fq) {\n    this._lfcf.dampening = fq;\n  }\n  triggerAttack(note, time) {\n    const freq = this.toFrequency(note);\n    time = this.toSeconds(time);\n    const delayAmount = 1 / freq;\n    this._lfcf.delayTime.setValueAtTime(delayAmount, time);\n    this._noise.start(time);\n    this._noise.stop(time + delayAmount * this.attackNoise);\n    this._lfcf.resonance.cancelScheduledValues(time);\n    this._lfcf.resonance.setValueAtTime(this.resonance, time);\n    return this;\n  }\n  /**\n   * Ramp down the [[resonance]] to 0 over the duration of the release time.\n   */\n  triggerRelease(time) {\n    this._lfcf.resonance.linearRampTo(0, this.release, time);\n    return this;\n  }\n  dispose() {\n    super.dispose();\n    this._noise.dispose();\n    this._lfcf.dispose();\n    return this;\n  }\n}","map":{"version":3,"names":["LowpassCombFilter","deepMerge","optionsFromArguments","Noise","Instrument","PluckSynth","constructor","getDefaults","arguments","name","options","_noise","context","type","attackNoise","_lfcf","dampening","resonance","release","connect","output","fq","triggerAttack","note","time","freq","toFrequency","toSeconds","delayAmount","delayTime","setValueAtTime","start","stop","cancelScheduledValues","triggerRelease","linearRampTo","dispose"],"sources":["../../../Tone/instrument/PluckSynth.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}