{"ast":null,"code":"import { __awaiter, __decorate } from \"tslib\";\nimport { ToneAudioBuffer } from \"../../core/context/ToneAudioBuffer\";\nimport { defaultArg, optionsFromArguments } from \"../../core/util/Defaults\";\nimport { noOp } from \"../../core/util/Interface\";\nimport { isUndef } from \"../../core/util/TypeCheck\";\nimport { Source } from \"../Source\";\nimport { ToneBufferSource } from \"./ToneBufferSource\";\nimport { assertRange } from \"../../core/util/Debug\";\nimport { timeRange } from \"../../core/util/Decorator\";\n/**\n * Player is an audio file player with start, loop, and stop functions.\n * @example\n * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/gong_1.mp3\").toDestination();\n * // play as soon as the buffer is loaded\n * player.autostart = true;\n * @category Source\n */\nexport class Player extends Source {\n  constructor() {\n    super(optionsFromArguments(Player.getDefaults(), arguments, [\"url\", \"onload\"]));\n    this.name = \"Player\";\n    /**\n     * All of the active buffer source nodes\n     */\n    this._activeSources = new Set();\n    const options = optionsFromArguments(Player.getDefaults(), arguments, [\"url\", \"onload\"]);\n    this._buffer = new ToneAudioBuffer({\n      onload: this._onload.bind(this, options.onload),\n      onerror: options.onerror,\n      reverse: options.reverse,\n      url: options.url\n    });\n    this.autostart = options.autostart;\n    this._loop = options.loop;\n    this._loopStart = options.loopStart;\n    this._loopEnd = options.loopEnd;\n    this._playbackRate = options.playbackRate;\n    this.fadeIn = options.fadeIn;\n    this.fadeOut = options.fadeOut;\n  }\n  static getDefaults() {\n    return Object.assign(Source.getDefaults(), {\n      autostart: false,\n      fadeIn: 0,\n      fadeOut: 0,\n      loop: false,\n      loopEnd: 0,\n      loopStart: 0,\n      onload: noOp,\n      onerror: noOp,\n      playbackRate: 1,\n      reverse: false\n    });\n  }\n  /**\n   * Load the audio file as an audio buffer.\n   * Decodes the audio asynchronously and invokes\n   * the callback once the audio buffer loads.\n   * Note: this does not need to be called if a url\n   * was passed in to the constructor. Only use this\n   * if you want to manually load a new url.\n   * @param url The url of the buffer to load. Filetype support depends on the browser.\n   */\n  load(url) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this._buffer.load(url);\n      this._onload();\n      return this;\n    });\n  }\n  /**\n   * Internal callback when the buffer is loaded.\n   */\n  _onload(callback = noOp) {\n    callback();\n    if (this.autostart) {\n      this.start();\n    }\n  }\n  /**\n   * Internal callback when the buffer is done playing.\n   */\n  _onSourceEnd(source) {\n    // invoke the onstop function\n    this.onstop(this);\n    // delete the source from the active sources\n    this._activeSources.delete(source);\n    if (this._activeSources.size === 0 && !this._synced && this._state.getValueAtTime(this.now()) === \"started\") {\n      // remove the 'implicitEnd' event and replace with an explicit end\n      this._state.cancel(this.now());\n      this._state.setStateAtTime(\"stopped\", this.now());\n    }\n  }\n  /**\n   * Play the buffer at the given startTime. Optionally add an offset\n   * and/or duration which will play the buffer from a position\n   * within the buffer for the given duration.\n   *\n   * @param  time When the player should start.\n   * @param  offset The offset from the beginning of the sample to start at.\n   * @param  duration How long the sample should play. If no duration is given, it will default to the full length of the sample (minus any offset)\n   */\n  start(time, offset, duration) {\n    super.start(time, offset, duration);\n    return this;\n  }\n  /**\n   * Internal start method\n   */\n  _start(startTime, offset, duration) {\n    // if it's a loop the default offset is the loopStart point\n    if (this._loop) {\n      offset = defaultArg(offset, this._loopStart);\n    } else {\n      // otherwise the default offset is 0\n      offset = defaultArg(offset, 0);\n    }\n    // compute the values in seconds\n    const computedOffset = this.toSeconds(offset);\n    // compute the duration which is either the passed in duration of the buffer.duration - offset\n    const origDuration = duration;\n    duration = defaultArg(duration, Math.max(this._buffer.duration - computedOffset, 0));\n    let computedDuration = this.toSeconds(duration);\n    // scale it by the playback rate\n    computedDuration = computedDuration / this._playbackRate;\n    // get the start time\n    startTime = this.toSeconds(startTime);\n    // make the source\n    const source = new ToneBufferSource({\n      url: this._buffer,\n      context: this.context,\n      fadeIn: this.fadeIn,\n      fadeOut: this.fadeOut,\n      loop: this._loop,\n      loopEnd: this._loopEnd,\n      loopStart: this._loopStart,\n      onended: this._onSourceEnd.bind(this),\n      playbackRate: this._playbackRate\n    }).connect(this.output);\n    // set the looping properties\n    if (!this._loop && !this._synced) {\n      // cancel the previous stop\n      this._state.cancel(startTime + computedDuration);\n      // if it's not looping, set the state change at the end of the sample\n      this._state.setStateAtTime(\"stopped\", startTime + computedDuration, {\n        implicitEnd: true\n      });\n    }\n    // add it to the array of active sources\n    this._activeSources.add(source);\n    // start it\n    if (this._loop && isUndef(origDuration)) {\n      source.start(startTime, computedOffset);\n    } else {\n      // subtract the fade out time\n      source.start(startTime, computedOffset, computedDuration - this.toSeconds(this.fadeOut));\n    }\n  }\n  /**\n   * Stop playback.\n   */\n  _stop(time) {\n    const computedTime = this.toSeconds(time);\n    this._activeSources.forEach(source => source.stop(computedTime));\n  }\n  /**\n   * Stop and then restart the player from the beginning (or offset)\n   * @param  time When the player should start.\n   * @param  offset The offset from the beginning of the sample to start at.\n   * @param  duration How long the sample should play. If no duration is given,\n   * \t\t\t\t\tit will default to the full length of the sample (minus any offset)\n   */\n  restart(time, offset, duration) {\n    super.restart(time, offset, duration);\n    return this;\n  }\n  _restart(time, offset, duration) {\n    this._stop(time);\n    this._start(time, offset, duration);\n  }\n  /**\n   * Seek to a specific time in the player's buffer. If the\n   * source is no longer playing at that time, it will stop.\n   * @param offset The time to seek to.\n   * @param when The time for the seek event to occur.\n   * @example\n   * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/gurgling_theremin_1.mp3\", () => {\n   * \tplayer.start();\n   * \t// seek to the offset in 1 second from now\n   * \tplayer.seek(0.4, \"+1\");\n   * }).toDestination();\n   */\n  seek(offset, when) {\n    const computedTime = this.toSeconds(when);\n    if (this._state.getValueAtTime(computedTime) === \"started\") {\n      const computedOffset = this.toSeconds(offset);\n      // if it's currently playing, stop it\n      this._stop(computedTime);\n      // restart it at the given time\n      this._start(computedTime, computedOffset);\n    }\n    return this;\n  }\n  /**\n   * Set the loop start and end. Will only loop if loop is set to true.\n   * @param loopStart The loop start time\n   * @param loopEnd The loop end time\n   * @example\n   * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/malevoices_aa2_F3.mp3\").toDestination();\n   * // loop between the given points\n   * player.setLoopPoints(0.2, 0.3);\n   * player.loop = true;\n   * player.autostart = true;\n   */\n  setLoopPoints(loopStart, loopEnd) {\n    this.loopStart = loopStart;\n    this.loopEnd = loopEnd;\n    return this;\n  }\n  /**\n   * If loop is true, the loop will start at this position.\n   */\n  get loopStart() {\n    return this._loopStart;\n  }\n  set loopStart(loopStart) {\n    this._loopStart = loopStart;\n    if (this.buffer.loaded) {\n      assertRange(this.toSeconds(loopStart), 0, this.buffer.duration);\n    }\n    // get the current source\n    this._activeSources.forEach(source => {\n      source.loopStart = loopStart;\n    });\n  }\n  /**\n   * If loop is true, the loop will end at this position.\n   */\n  get loopEnd() {\n    return this._loopEnd;\n  }\n  set loopEnd(loopEnd) {\n    this._loopEnd = loopEnd;\n    if (this.buffer.loaded) {\n      assertRange(this.toSeconds(loopEnd), 0, this.buffer.duration);\n    }\n    // get the current source\n    this._activeSources.forEach(source => {\n      source.loopEnd = loopEnd;\n    });\n  }\n  /**\n   * The audio buffer belonging to the player.\n   */\n  get buffer() {\n    return this._buffer;\n  }\n  set buffer(buffer) {\n    this._buffer.set(buffer);\n  }\n  /**\n   * If the buffer should loop once it's over.\n   * @example\n   * const player = new Tone.Player(\"https://tonejs.github.io/audio/drum-samples/breakbeat.mp3\").toDestination();\n   * player.loop = true;\n   * player.autostart = true;\n   */\n  get loop() {\n    return this._loop;\n  }\n  set loop(loop) {\n    // if no change, do nothing\n    if (this._loop === loop) {\n      return;\n    }\n    this._loop = loop;\n    // set the loop of all of the sources\n    this._activeSources.forEach(source => {\n      source.loop = loop;\n    });\n    if (loop) {\n      // remove the next stopEvent\n      const stopEvent = this._state.getNextState(\"stopped\", this.now());\n      if (stopEvent) {\n        this._state.cancel(stopEvent.time);\n      }\n    }\n  }\n  /**\n   * Normal speed is 1. The pitch will change with the playback rate.\n   * @example\n   * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/femalevoices_aa2_A5.mp3\").toDestination();\n   * // play at 1/4 speed\n   * player.playbackRate = 0.25;\n   * // play as soon as the buffer is loaded\n   * player.autostart = true;\n   */\n  get playbackRate() {\n    return this._playbackRate;\n  }\n  set playbackRate(rate) {\n    this._playbackRate = rate;\n    const now = this.now();\n    // cancel the stop event since it's at a different time now\n    const stopEvent = this._state.getNextState(\"stopped\", now);\n    if (stopEvent && stopEvent.implicitEnd) {\n      this._state.cancel(stopEvent.time);\n      this._activeSources.forEach(source => source.cancelStop());\n    }\n    // set all the sources\n    this._activeSources.forEach(source => {\n      source.playbackRate.setValueAtTime(rate, now);\n    });\n  }\n  /**\n   * If the buffer should be reversed\n   * @example\n   * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/chime_1.mp3\").toDestination();\n   * player.autostart = true;\n   * player.reverse = true;\n   */\n  get reverse() {\n    return this._buffer.reverse;\n  }\n  set reverse(rev) {\n    this._buffer.reverse = rev;\n  }\n  /**\n   * If the buffer is loaded\n   */\n  get loaded() {\n    return this._buffer.loaded;\n  }\n  dispose() {\n    super.dispose();\n    // disconnect all of the players\n    this._activeSources.forEach(source => source.dispose());\n    this._activeSources.clear();\n    this._buffer.dispose();\n    return this;\n  }\n}\n__decorate([timeRange(0)], Player.prototype, \"fadeIn\", void 0);\n__decorate([timeRange(0)], Player.prototype, \"fadeOut\", void 0);","map":{"version":3,"names":["ToneAudioBuffer","defaultArg","optionsFromArguments","noOp","isUndef","Source","ToneBufferSource","assertRange","timeRange","Player","constructor","getDefaults","arguments","name","_activeSources","Set","options","_buffer","onload","_onload","bind","onerror","reverse","url","autostart","_loop","loop","_loopStart","loopStart","_loopEnd","loopEnd","_playbackRate","playbackRate","fadeIn","fadeOut","Object","assign","load","callback","start","_onSourceEnd","source","onstop","delete","size","_synced","_state","getValueAtTime","now","cancel","setStateAtTime","time","offset","duration","_start","startTime","computedOffset","toSeconds","origDuration","Math","max","computedDuration","context","onended","connect","output","implicitEnd","add","_stop","computedTime","forEach","stop","restart","_restart","seek","when","setLoopPoints","buffer","loaded","set","stopEvent","getNextState","rate","cancelStop","setValueAtTime","rev","dispose","clear","__decorate"],"sources":["../../../../Tone/source/buffer/Player.ts"],"sourcesContent":[null],"mappings":";AAAA,SAASA,eAAe,QAAQ,oCAAoC;AAEpE,SAASC,UAAU,EAAEC,oBAAoB,QAAQ,0BAA0B;AAC3E,SAASC,IAAI,QAAQ,2BAA2B;AAChD,SAASC,OAAO,QAAQ,2BAA2B;AACnD,SAASC,MAAM,QAAuB,WAAW;AACjD,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,WAAW,QAAQ,uBAAuB;AACnD,SAASC,SAAS,QAAQ,2BAA2B;AAgBrD;;;;;;;;AAQA,OAAM,MAAOC,MAAO,SAAQJ,MAAqB;EA0DhDK,YAAA;IAEC,KAAK,CAACR,oBAAoB,CAACO,MAAM,CAACE,WAAW,EAAE,EAAEC,SAAS,EAAE,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;IA1DvE,KAAAC,IAAI,GAAW,QAAQ;IAiChC;;;IAGQ,KAAAC,cAAc,GAA0B,IAAIC,GAAG,EAAE;IAuBxD,MAAMC,OAAO,GAAGd,oBAAoB,CAACO,MAAM,CAACE,WAAW,EAAE,EAAEC,SAAS,EAAE,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IAExF,IAAI,CAACK,OAAO,GAAG,IAAIjB,eAAe,CAAC;MAClCkB,MAAM,EAAE,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,IAAI,EAAEJ,OAAO,CAACE,MAAM,CAAC;MAC/CG,OAAO,EAAEL,OAAO,CAACK,OAAO;MACxBC,OAAO,EAAEN,OAAO,CAACM,OAAO;MACxBC,GAAG,EAAEP,OAAO,CAACO;KACb,CAAC;IACF,IAAI,CAACC,SAAS,GAAGR,OAAO,CAACQ,SAAS;IAClC,IAAI,CAACC,KAAK,GAAGT,OAAO,CAACU,IAAI;IACzB,IAAI,CAACC,UAAU,GAAGX,OAAO,CAACY,SAAS;IACnC,IAAI,CAACC,QAAQ,GAAGb,OAAO,CAACc,OAAO;IAC/B,IAAI,CAACC,aAAa,GAAGf,OAAO,CAACgB,YAAY;IACzC,IAAI,CAACC,MAAM,GAAGjB,OAAO,CAACiB,MAAM;IAC5B,IAAI,CAACC,OAAO,GAAGlB,OAAO,CAACkB,OAAO;EAC/B;EAEA,OAAOvB,WAAWA,CAAA;IACjB,OAAOwB,MAAM,CAACC,MAAM,CAAC/B,MAAM,CAACM,WAAW,EAAE,EAAE;MAC1Ca,SAAS,EAAE,KAAK;MAChBS,MAAM,EAAE,CAAC;MACTC,OAAO,EAAE,CAAC;MACVR,IAAI,EAAE,KAAK;MACXI,OAAO,EAAE,CAAC;MACVF,SAAS,EAAE,CAAC;MACZV,MAAM,EAAEf,IAAI;MACZkB,OAAO,EAAElB,IAAI;MACb6B,YAAY,EAAE,CAAC;MACfV,OAAO,EAAE;KACT,CAAC;EACH;EAEA;;;;;;;;;EASMe,IAAIA,CAACd,GAAW;;MACrB,MAAM,IAAI,CAACN,OAAO,CAACoB,IAAI,CAACd,GAAG,CAAC;MAC5B,IAAI,CAACJ,OAAO,EAAE;MACd,OAAO,IAAI;IACZ,CAAC;;EAED;;;EAGQA,OAAOA,CAACmB,QAAA,GAAuBnC,IAAI;IAC1CmC,QAAQ,EAAE;IACV,IAAI,IAAI,CAACd,SAAS,EAAE;MACnB,IAAI,CAACe,KAAK,EAAE;;EAEd;EAEA;;;EAGQC,YAAYA,CAACC,MAAwB;IAC5C;IACA,IAAI,CAACC,MAAM,CAAC,IAAI,CAAC;IAEjB;IACA,IAAI,CAAC5B,cAAc,CAAC6B,MAAM,CAACF,MAAM,CAAC;IAClC,IAAI,IAAI,CAAC3B,cAAc,CAAC8B,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,CAACC,OAAO,IAClD,IAAI,CAACC,MAAM,CAACC,cAAc,CAAC,IAAI,CAACC,GAAG,EAAE,CAAC,KAAK,SAAS,EAAE;MACtD;MACA,IAAI,CAACF,MAAM,CAACG,MAAM,CAAC,IAAI,CAACD,GAAG,EAAE,CAAC;MAC9B,IAAI,CAACF,MAAM,CAACI,cAAc,CAAC,SAAS,EAAE,IAAI,CAACF,GAAG,EAAE,CAAC;;EAEnD;EAEA;;;;;;;;;EASAT,KAAKA,CAACY,IAAW,EAAEC,MAAa,EAAEC,QAAe;IAChD,KAAK,CAACd,KAAK,CAACY,IAAI,EAAEC,MAAM,EAAEC,QAAQ,CAAC;IACnC,OAAO,IAAI;EACZ;EAEA;;;EAGUC,MAAMA,CAACC,SAAgB,EAAEH,MAAa,EAAEC,QAAe;IAChE;IACA,IAAI,IAAI,CAAC5B,KAAK,EAAE;MACf2B,MAAM,GAAGnD,UAAU,CAACmD,MAAM,EAAE,IAAI,CAACzB,UAAU,CAAC;KAC5C,MAAM;MACN;MACAyB,MAAM,GAAGnD,UAAU,CAACmD,MAAM,EAAE,CAAC,CAAC;;IAG/B;IACA,MAAMI,cAAc,GAAG,IAAI,CAACC,SAAS,CAACL,MAAM,CAAC;IAE7C;IACA,MAAMM,YAAY,GAAGL,QAAQ;IAC7BA,QAAQ,GAAGpD,UAAU,CAACoD,QAAQ,EAAEM,IAAI,CAACC,GAAG,CAAC,IAAI,CAAC3C,OAAO,CAACoC,QAAQ,GAAGG,cAAc,EAAE,CAAC,CAAC,CAAC;IACpF,IAAIK,gBAAgB,GAAG,IAAI,CAACJ,SAAS,CAACJ,QAAQ,CAAC;IAE/C;IACAQ,gBAAgB,GAAGA,gBAAgB,GAAG,IAAI,CAAC9B,aAAa;IAExD;IACAwB,SAAS,GAAG,IAAI,CAACE,SAAS,CAACF,SAAS,CAAC;IAErC;IACA,MAAMd,MAAM,GAAG,IAAInC,gBAAgB,CAAC;MACnCiB,GAAG,EAAE,IAAI,CAACN,OAAO;MACjB6C,OAAO,EAAE,IAAI,CAACA,OAAO;MACrB7B,MAAM,EAAE,IAAI,CAACA,MAAM;MACnBC,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBR,IAAI,EAAE,IAAI,CAACD,KAAK;MAChBK,OAAO,EAAE,IAAI,CAACD,QAAQ;MACtBD,SAAS,EAAE,IAAI,CAACD,UAAU;MAC1BoC,OAAO,EAAE,IAAI,CAACvB,YAAY,CAACpB,IAAI,CAAC,IAAI,CAAC;MACrCY,YAAY,EAAE,IAAI,CAACD;KACnB,CAAC,CAACiC,OAAO,CAAC,IAAI,CAACC,MAAM,CAAC;IAEvB;IACA,IAAI,CAAC,IAAI,CAACxC,KAAK,IAAI,CAAC,IAAI,CAACoB,OAAO,EAAE;MACjC;MACA,IAAI,CAACC,MAAM,CAACG,MAAM,CAACM,SAAS,GAAGM,gBAAgB,CAAC;MAChD;MACA,IAAI,CAACf,MAAM,CAACI,cAAc,CAAC,SAAS,EAAEK,SAAS,GAAGM,gBAAgB,EAAE;QACnEK,WAAW,EAAE;OACb,CAAC;;IAGH;IACA,IAAI,CAACpD,cAAc,CAACqD,GAAG,CAAC1B,MAAM,CAAC;IAE/B;IACA,IAAI,IAAI,CAAChB,KAAK,IAAIrB,OAAO,CAACsD,YAAY,CAAC,EAAE;MACxCjB,MAAM,CAACF,KAAK,CAACgB,SAAS,EAAEC,cAAc,CAAC;KACvC,MAAM;MACN;MACAf,MAAM,CAACF,KAAK,CAACgB,SAAS,EAAEC,cAAc,EAAEK,gBAAgB,GAAG,IAAI,CAACJ,SAAS,CAAC,IAAI,CAACvB,OAAO,CAAC,CAAC;;EAE1F;EAEA;;;EAGUkC,KAAKA,CAACjB,IAAW;IAC1B,MAAMkB,YAAY,GAAG,IAAI,CAACZ,SAAS,CAACN,IAAI,CAAC;IACzC,IAAI,CAACrC,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAIA,MAAM,CAAC8B,IAAI,CAACF,YAAY,CAAC,CAAC;EACjE;EAEA;;;;;;;EAOAG,OAAOA,CAACrB,IAAc,EAAEC,MAAa,EAAEC,QAAe;IACrD,KAAK,CAACmB,OAAO,CAACrB,IAAI,EAAEC,MAAM,EAAEC,QAAQ,CAAC;IACrC,OAAO,IAAI;EACZ;EAEUoB,QAAQA,CAACtB,IAAc,EAAEC,MAAa,EAAEC,QAAe;IAChE,IAAI,CAACe,KAAK,CAACjB,IAAI,CAAC;IAChB,IAAI,CAACG,MAAM,CAACH,IAAI,EAAEC,MAAM,EAAEC,QAAQ,CAAC;EACpC;EAEA;;;;;;;;;;;;EAYAqB,IAAIA,CAACtB,MAAY,EAAEuB,IAAW;IAC7B,MAAMN,YAAY,GAAG,IAAI,CAACZ,SAAS,CAACkB,IAAI,CAAC;IACzC,IAAI,IAAI,CAAC7B,MAAM,CAACC,cAAc,CAACsB,YAAY,CAAC,KAAK,SAAS,EAAE;MAC3D,MAAMb,cAAc,GAAG,IAAI,CAACC,SAAS,CAACL,MAAM,CAAC;MAC7C;MACA,IAAI,CAACgB,KAAK,CAACC,YAAY,CAAC;MACxB;MACA,IAAI,CAACf,MAAM,CAACe,YAAY,EAAEb,cAAc,CAAC;;IAE1C,OAAO,IAAI;EACZ;EAEA;;;;;;;;;;;EAWAoB,aAAaA,CAAChD,SAAe,EAAEE,OAAa;IAC3C,IAAI,CAACF,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACE,OAAO,GAAGA,OAAO;IACtB,OAAO,IAAI;EACZ;EAEA;;;EAGA,IAAIF,SAASA,CAAA;IACZ,OAAO,IAAI,CAACD,UAAU;EACvB;EACA,IAAIC,SAASA,CAACA,SAAS;IACtB,IAAI,CAACD,UAAU,GAAGC,SAAS;IAC3B,IAAI,IAAI,CAACiD,MAAM,CAACC,MAAM,EAAE;MACvBvE,WAAW,CAAC,IAAI,CAACkD,SAAS,CAAC7B,SAAS,CAAC,EAAE,CAAC,EAAE,IAAI,CAACiD,MAAM,CAACxB,QAAQ,CAAC;;IAEhE;IACA,IAAI,CAACvC,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAG;MACpCA,MAAM,CAACb,SAAS,GAAGA,SAAS;IAC7B,CAAC,CAAC;EACH;EAEA;;;EAGA,IAAIE,OAAOA,CAAA;IACV,OAAO,IAAI,CAACD,QAAQ;EACrB;EACA,IAAIC,OAAOA,CAACA,OAAO;IAClB,IAAI,CAACD,QAAQ,GAAGC,OAAO;IACvB,IAAI,IAAI,CAAC+C,MAAM,CAACC,MAAM,EAAE;MACvBvE,WAAW,CAAC,IAAI,CAACkD,SAAS,CAAC3B,OAAO,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC+C,MAAM,CAACxB,QAAQ,CAAC;;IAE9D;IACA,IAAI,CAACvC,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAG;MACpCA,MAAM,CAACX,OAAO,GAAGA,OAAO;IACzB,CAAC,CAAC;EACH;EAEA;;;EAGA,IAAI+C,MAAMA,CAAA;IACT,OAAO,IAAI,CAAC5D,OAAO;EACpB;EACA,IAAI4D,MAAMA,CAACA,MAAM;IAChB,IAAI,CAAC5D,OAAO,CAAC8D,GAAG,CAACF,MAAM,CAAC;EACzB;EAEA;;;;;;;EAOA,IAAInD,IAAIA,CAAA;IACP,OAAO,IAAI,CAACD,KAAK;EAClB;EACA,IAAIC,IAAIA,CAACA,IAAI;IACZ;IACA,IAAI,IAAI,CAACD,KAAK,KAAKC,IAAI,EAAE;MACxB;;IAED,IAAI,CAACD,KAAK,GAAGC,IAAI;IACjB;IACA,IAAI,CAACZ,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAG;MACpCA,MAAM,CAACf,IAAI,GAAGA,IAAI;IACnB,CAAC,CAAC;IACF,IAAIA,IAAI,EAAE;MACT;MACA,MAAMsD,SAAS,GAAG,IAAI,CAAClC,MAAM,CAACmC,YAAY,CAAC,SAAS,EAAE,IAAI,CAACjC,GAAG,EAAE,CAAC;MACjE,IAAIgC,SAAS,EAAE;QACd,IAAI,CAAClC,MAAM,CAACG,MAAM,CAAC+B,SAAS,CAAC7B,IAAI,CAAC;;;EAGrC;EAEA;;;;;;;;;EASA,IAAInB,YAAYA,CAAA;IACf,OAAO,IAAI,CAACD,aAAa;EAC1B;EACA,IAAIC,YAAYA,CAACkD,IAAI;IACpB,IAAI,CAACnD,aAAa,GAAGmD,IAAI;IACzB,MAAMlC,GAAG,GAAG,IAAI,CAACA,GAAG,EAAE;IAEtB;IACA,MAAMgC,SAAS,GAAG,IAAI,CAAClC,MAAM,CAACmC,YAAY,CAAC,SAAS,EAAEjC,GAAG,CAAC;IAC1D,IAAIgC,SAAS,IAAIA,SAAS,CAACd,WAAW,EAAE;MACvC,IAAI,CAACpB,MAAM,CAACG,MAAM,CAAC+B,SAAS,CAAC7B,IAAI,CAAC;MAClC,IAAI,CAACrC,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAIA,MAAM,CAAC0C,UAAU,EAAE,CAAC;;IAG3D;IACA,IAAI,CAACrE,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAG;MACpCA,MAAM,CAACT,YAAY,CAACoD,cAAc,CAACF,IAAI,EAAElC,GAAG,CAAC;IAC9C,CAAC,CAAC;EACH;EAEA;;;;;;;EAOA,IAAI1B,OAAOA,CAAA;IACV,OAAO,IAAI,CAACL,OAAO,CAACK,OAAO;EAC5B;EACA,IAAIA,OAAOA,CAAC+D,GAAG;IACd,IAAI,CAACpE,OAAO,CAACK,OAAO,GAAG+D,GAAG;EAC3B;EAEA;;;EAGA,IAAIP,MAAMA,CAAA;IACT,OAAO,IAAI,CAAC7D,OAAO,CAAC6D,MAAM;EAC3B;EAEAQ,OAAOA,CAAA;IACN,KAAK,CAACA,OAAO,EAAE;IACf;IACA,IAAI,CAACxE,cAAc,CAACwD,OAAO,CAAC7B,MAAM,IAAIA,MAAM,CAAC6C,OAAO,EAAE,CAAC;IACvD,IAAI,CAACxE,cAAc,CAACyE,KAAK,EAAE;IAC3B,IAAI,CAACtE,OAAO,CAACqE,OAAO,EAAE;IACtB,OAAO,IAAI;EACZ;;AA1WAE,UAAA,EADChF,SAAS,CAAC,CAAC,CAAC,C,qCACA;AAMbgF,UAAA,EADChF,SAAS,CAAC,CAAC,CAAC,C,sCACC"},"metadata":{},"sourceType":"module","externalDependencies":[]}