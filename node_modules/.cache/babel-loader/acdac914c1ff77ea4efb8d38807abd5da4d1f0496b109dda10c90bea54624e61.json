{"ast":null,"code":"import { StereoFeedbackEffect } from \"../effect/StereoFeedbackEffect\";\nimport { optionsFromArguments } from \"../core/util/Defaults\";\nimport { LFO } from \"../source/oscillator/LFO\";\nimport { Delay } from \"../core/context/Delay\";\nimport { readOnly } from \"../core/util/Interface\";\n/**\n * Chorus is a stereo chorus effect composed of a left and right delay with an [[LFO]] applied to the delayTime of each channel.\n * When [[feedback]] is set to a value larger than 0, you also get Flanger-type effects.\n * Inspiration from [Tuna.js](https://github.com/Dinahmoe/tuna/blob/master/tuna.js).\n * Read more on the chorus effect on [SoundOnSound](http://www.soundonsound.com/sos/jun04/articles/synthsecrets.htm).\n *\n * @example\n * const chorus = new Tone.Chorus(4, 2.5, 0.5).toDestination().start();\n * const synth = new Tone.PolySynth().connect(chorus);\n * synth.triggerAttackRelease([\"C3\", \"E3\", \"G3\"], \"8n\");\n *\n * @category Effect\n */\nexport class Chorus extends StereoFeedbackEffect {\n  constructor() {\n    super(optionsFromArguments(Chorus.getDefaults(), arguments, [\"frequency\", \"delayTime\", \"depth\"]));\n    this.name = \"Chorus\";\n    const options = optionsFromArguments(Chorus.getDefaults(), arguments, [\"frequency\", \"delayTime\", \"depth\"]);\n    this._depth = options.depth;\n    this._delayTime = options.delayTime / 1000;\n    this._lfoL = new LFO({\n      context: this.context,\n      frequency: options.frequency,\n      min: 0,\n      max: 1\n    });\n    this._lfoR = new LFO({\n      context: this.context,\n      frequency: options.frequency,\n      min: 0,\n      max: 1,\n      phase: 180\n    });\n    this._delayNodeL = new Delay({\n      context: this.context\n    });\n    this._delayNodeR = new Delay({\n      context: this.context\n    });\n    this.frequency = this._lfoL.frequency;\n    readOnly(this, [\"frequency\"]);\n    // have one LFO frequency control the other\n    this._lfoL.frequency.connect(this._lfoR.frequency);\n    // connections\n    this.connectEffectLeft(this._delayNodeL);\n    this.connectEffectRight(this._delayNodeR);\n    // lfo setup\n    this._lfoL.connect(this._delayNodeL.delayTime);\n    this._lfoR.connect(this._delayNodeR.delayTime);\n    // set the initial values\n    this.depth = this._depth;\n    this.type = options.type;\n    this.spread = options.spread;\n  }\n  static getDefaults() {\n    return Object.assign(StereoFeedbackEffect.getDefaults(), {\n      frequency: 1.5,\n      delayTime: 3.5,\n      depth: 0.7,\n      type: \"sine\",\n      spread: 180,\n      feedback: 0,\n      wet: 0.5\n    });\n  }\n  /**\n   * The depth of the effect. A depth of 1 makes the delayTime\n   * modulate between 0 and 2*delayTime (centered around the delayTime).\n   */\n  get depth() {\n    return this._depth;\n  }\n  set depth(depth) {\n    this._depth = depth;\n    const deviation = this._delayTime * depth;\n    this._lfoL.min = Math.max(this._delayTime - deviation, 0);\n    this._lfoL.max = this._delayTime + deviation;\n    this._lfoR.min = Math.max(this._delayTime - deviation, 0);\n    this._lfoR.max = this._delayTime + deviation;\n  }\n  /**\n   * The delayTime in milliseconds of the chorus. A larger delayTime\n   * will give a more pronounced effect. Nominal range a delayTime\n   * is between 2 and 20ms.\n   */\n  get delayTime() {\n    return this._delayTime * 1000;\n  }\n  set delayTime(delayTime) {\n    this._delayTime = delayTime / 1000;\n    this.depth = this._depth;\n  }\n  /**\n   * The oscillator type of the LFO.\n   */\n  get type() {\n    return this._lfoL.type;\n  }\n  set type(type) {\n    this._lfoL.type = type;\n    this._lfoR.type = type;\n  }\n  /**\n   * Amount of stereo spread. When set to 0, both LFO's will be panned centrally.\n   * When set to 180, LFO's will be panned hard left and right respectively.\n   */\n  get spread() {\n    return this._lfoR.phase - this._lfoL.phase;\n  }\n  set spread(spread) {\n    this._lfoL.phase = 90 - spread / 2;\n    this._lfoR.phase = spread / 2 + 90;\n  }\n  /**\n   * Start the effect.\n   */\n  start(time) {\n    this._lfoL.start(time);\n    this._lfoR.start(time);\n    return this;\n  }\n  /**\n   * Stop the lfo\n   */\n  stop(time) {\n    this._lfoL.stop(time);\n    this._lfoR.stop(time);\n    return this;\n  }\n  /**\n   * Sync the filter to the transport. See [[LFO.sync]]\n   */\n  sync() {\n    this._lfoL.sync();\n    this._lfoR.sync();\n    return this;\n  }\n  /**\n   * Unsync the filter from the transport.\n   */\n  unsync() {\n    this._lfoL.unsync();\n    this._lfoR.unsync();\n    return this;\n  }\n  dispose() {\n    super.dispose();\n    this._lfoL.dispose();\n    this._lfoR.dispose();\n    this._delayNodeL.dispose();\n    this._delayNodeR.dispose();\n    this.frequency.dispose();\n    return this;\n  }\n}","map":{"version":3,"names":["StereoFeedbackEffect","optionsFromArguments","LFO","Delay","readOnly","Chorus","constructor","getDefaults","arguments","name","options","_depth","depth","_delayTime","delayTime","_lfoL","context","frequency","min","max","_lfoR","phase","_delayNodeL","_delayNodeR","connect","connectEffectLeft","connectEffectRight","type","spread","Object","assign","feedback","wet","deviation","Math","start","time","stop","sync","unsync","dispose"],"sources":["../../../Tone/effect/Chorus.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,oBAAoB,QAAqC,gCAAgC;AAGlG,SAASC,oBAAoB,QAAQ,uBAAuB;AAC5D,SAASC,GAAG,QAAQ,0BAA0B;AAC9C,SAASC,KAAK,QAAQ,uBAAuB;AAE7C,SAASC,QAAQ,QAAQ,wBAAwB;AAUjD;;;;;;;;;;;;;AAaA,OAAM,MAAOC,MAAO,SAAQL,oBAAmC;EA8C9DM,YAAA;IAEC,KAAK,CAACL,oBAAoB,CAACI,MAAM,CAACE,WAAW,EAAE,EAAEC,SAAS,EAAE,CAAC,WAAW,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC,CAAC;IA9CzF,KAAAC,IAAI,GAAW,QAAQ;IA+C/B,MAAMC,OAAO,GAAGT,oBAAoB,CAACI,MAAM,CAACE,WAAW,EAAE,EAAEC,SAAS,EAAE,CAAC,WAAW,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC;IAE1G,IAAI,CAACG,MAAM,GAAGD,OAAO,CAACE,KAAK;IAC3B,IAAI,CAACC,UAAU,GAAGH,OAAO,CAACI,SAAS,GAAG,IAAI;IAC1C,IAAI,CAACC,KAAK,GAAG,IAAIb,GAAG,CAAC;MACpBc,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBC,SAAS,EAAEP,OAAO,CAACO,SAAS;MAC5BC,GAAG,EAAE,CAAC;MACNC,GAAG,EAAE;KACL,CAAC;IACF,IAAI,CAACC,KAAK,GAAG,IAAIlB,GAAG,CAAC;MACpBc,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBC,SAAS,EAAEP,OAAO,CAACO,SAAS;MAC5BC,GAAG,EAAE,CAAC;MACNC,GAAG,EAAE,CAAC;MACNE,KAAK,EAAE;KACP,CAAC;IACF,IAAI,CAACC,WAAW,GAAG,IAAInB,KAAK,CAAC;MAAEa,OAAO,EAAE,IAAI,CAACA;IAAO,CAAE,CAAC;IACvD,IAAI,CAACO,WAAW,GAAG,IAAIpB,KAAK,CAAC;MAAEa,OAAO,EAAE,IAAI,CAACA;IAAO,CAAE,CAAC;IACvD,IAAI,CAACC,SAAS,GAAG,IAAI,CAACF,KAAK,CAACE,SAAS;IACrCb,QAAQ,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC,CAAC;IAC7B;IACA,IAAI,CAACW,KAAK,CAACE,SAAS,CAACO,OAAO,CAAC,IAAI,CAACJ,KAAK,CAACH,SAAS,CAAC;IAElD;IACA,IAAI,CAACQ,iBAAiB,CAAC,IAAI,CAACH,WAAW,CAAC;IACxC,IAAI,CAACI,kBAAkB,CAAC,IAAI,CAACH,WAAW,CAAC;IACzC;IACA,IAAI,CAACR,KAAK,CAACS,OAAO,CAAC,IAAI,CAACF,WAAW,CAACR,SAAS,CAAC;IAC9C,IAAI,CAACM,KAAK,CAACI,OAAO,CAAC,IAAI,CAACD,WAAW,CAACT,SAAS,CAAC;IAC9C;IACA,IAAI,CAACF,KAAK,GAAG,IAAI,CAACD,MAAM;IACxB,IAAI,CAACgB,IAAI,GAAGjB,OAAO,CAACiB,IAAI;IACxB,IAAI,CAACC,MAAM,GAAGlB,OAAO,CAACkB,MAAM;EAC7B;EAEA,OAAOrB,WAAWA,CAAA;IACjB,OAAOsB,MAAM,CAACC,MAAM,CAAC9B,oBAAoB,CAACO,WAAW,EAAE,EAAE;MACxDU,SAAS,EAAE,GAAG;MACdH,SAAS,EAAE,GAAG;MACdF,KAAK,EAAE,GAAG;MACVe,IAAI,EAAE,MAAgB;MACtBC,MAAM,EAAE,GAAG;MACXG,QAAQ,EAAE,CAAC;MACXC,GAAG,EAAE;KACL,CAAC;EACH;EAEA;;;;EAIA,IAAIpB,KAAKA,CAAA;IACR,OAAO,IAAI,CAACD,MAAM;EACnB;EACA,IAAIC,KAAKA,CAACA,KAAK;IACd,IAAI,CAACD,MAAM,GAAGC,KAAK;IACnB,MAAMqB,SAAS,GAAG,IAAI,CAACpB,UAAU,GAAGD,KAAK;IACzC,IAAI,CAACG,KAAK,CAACG,GAAG,GAAGgB,IAAI,CAACf,GAAG,CAAC,IAAI,CAACN,UAAU,GAAGoB,SAAS,EAAE,CAAC,CAAC;IACzD,IAAI,CAAClB,KAAK,CAACI,GAAG,GAAG,IAAI,CAACN,UAAU,GAAGoB,SAAS;IAC5C,IAAI,CAACb,KAAK,CAACF,GAAG,GAAGgB,IAAI,CAACf,GAAG,CAAC,IAAI,CAACN,UAAU,GAAGoB,SAAS,EAAE,CAAC,CAAC;IACzD,IAAI,CAACb,KAAK,CAACD,GAAG,GAAG,IAAI,CAACN,UAAU,GAAGoB,SAAS;EAC7C;EAEA;;;;;EAKA,IAAInB,SAASA,CAAA;IACZ,OAAO,IAAI,CAACD,UAAU,GAAG,IAAI;EAC9B;EACA,IAAIC,SAASA,CAACA,SAAS;IACtB,IAAI,CAACD,UAAU,GAAGC,SAAS,GAAG,IAAI;IAClC,IAAI,CAACF,KAAK,GAAG,IAAI,CAACD,MAAM;EACzB;EAEA;;;EAGA,IAAIgB,IAAIA,CAAA;IACP,OAAO,IAAI,CAACZ,KAAK,CAACY,IAAI;EACvB;EACA,IAAIA,IAAIA,CAACA,IAAI;IACZ,IAAI,CAACZ,KAAK,CAACY,IAAI,GAAGA,IAAI;IACtB,IAAI,CAACP,KAAK,CAACO,IAAI,GAAGA,IAAI;EACvB;EAEA;;;;EAIA,IAAIC,MAAMA,CAAA;IACT,OAAO,IAAI,CAACR,KAAK,CAACC,KAAK,GAAG,IAAI,CAACN,KAAK,CAACM,KAAK;EAC3C;EACA,IAAIO,MAAMA,CAACA,MAAM;IAChB,IAAI,CAACb,KAAK,CAACM,KAAK,GAAG,EAAE,GAAIO,MAAM,GAAG,CAAE;IACpC,IAAI,CAACR,KAAK,CAACC,KAAK,GAAIO,MAAM,GAAG,CAAC,GAAI,EAAE;EACrC;EAEA;;;EAGAO,KAAKA,CAACC,IAAW;IAChB,IAAI,CAACrB,KAAK,CAACoB,KAAK,CAACC,IAAI,CAAC;IACtB,IAAI,CAAChB,KAAK,CAACe,KAAK,CAACC,IAAI,CAAC;IACtB,OAAO,IAAI;EACZ;EAEA;;;EAGAC,IAAIA,CAACD,IAAW;IACf,IAAI,CAACrB,KAAK,CAACsB,IAAI,CAACD,IAAI,CAAC;IACrB,IAAI,CAAChB,KAAK,CAACiB,IAAI,CAACD,IAAI,CAAC;IACrB,OAAO,IAAI;EACZ;EAEA;;;EAGAE,IAAIA,CAAA;IACH,IAAI,CAACvB,KAAK,CAACuB,IAAI,EAAE;IACjB,IAAI,CAAClB,KAAK,CAACkB,IAAI,EAAE;IACjB,OAAO,IAAI;EACZ;EAEA;;;EAGAC,MAAMA,CAAA;IACL,IAAI,CAACxB,KAAK,CAACwB,MAAM,EAAE;IACnB,IAAI,CAACnB,KAAK,CAACmB,MAAM,EAAE;IACnB,OAAO,IAAI;EACZ;EAEAC,OAAOA,CAAA;IACN,KAAK,CAACA,OAAO,EAAE;IACf,IAAI,CAACzB,KAAK,CAACyB,OAAO,EAAE;IACpB,IAAI,CAACpB,KAAK,CAACoB,OAAO,EAAE;IACpB,IAAI,CAAClB,WAAW,CAACkB,OAAO,EAAE;IAC1B,IAAI,CAACjB,WAAW,CAACiB,OAAO,EAAE;IAC1B,IAAI,CAACvB,SAAS,CAACuB,OAAO,EAAE;IACxB,OAAO,IAAI;EACZ"},"metadata":{},"sourceType":"module","externalDependencies":[]}